<!DOCTYPE html>
<html lang="en-us">
<head>
	<!-- HOWTO / FAQ / SETUP
		1) Add this file (SprestlibToolkit.html) to your 'SiteAssets' library
		2) Create a new Page named 'SprestlibToolkit' (SP will add the '.aspx' at the end)
		3) Add a Content Editor Web Part to the new page and point it to '../SiteAssets/SprestlibToolkit.html'
		4) Press the Save page button (top-left)
		5) The SprestlibToolkit.aspx page is ready to go!
		!!!==>> Check the img folder for screencaps of the SharePoint setup! <<==!!!
	-->
	<meta charset="utf-8">
	<meta name="author"      content="https://github.com/gitbrent/">
	<meta name="website"     content="https://github.com/gitbrent/SpRestLib/">
	<meta name="keywords"    content="SpRestLib, JavaScript, js-sharepoint, OData, REST, SharePoint 2013, SP2013, SharePoint 2016, SP2016, SharePoint Online">
	<meta name="description" content="Content Editor Webpart: SpRestLib SharePoint Toolkit">
	<meta name="revised"     content="Oct 10, 2017">

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">

	<style>
		abbr { cursor: help; }
		.ms-webpartPage-root { border-spacing: 0px; }
		#divBody {
			font-family: 'Segoe UI','Helvetica Neue','Open Sans',sans-serif;
			color: #696969;
			margin: -10px 30px 10px 30px;
		}
		#divBody div { box-sizing: border-box; }

		#titleBox { margin-bottom: 20px; }
		.bigTitle { font-family:'Segoe UI Light','Roboto'; font-size:36px; color:#0088cc; margin-bottom: 10px }
		.bigTitsu { font-size:14px; color:#c7c7c7; }
		#siteLogo { max-height:60px; max-width:250px; }

		.sectionTitle, .subTitle { font-size:18px; color:#0088cc; margin:20px 0 10px 0; cursor: pointer; }
		.sectionTitle.plain, .subTitle.plain { display: inline-block; cursor: default; }
		.bigger { font-size:1.1em; }
		.arrow {
			display: inline-block;
			height: 12px; width: 12px;
			border-top: 3px solid #0085C3; border-right: 3px solid #0085C3;
			margin-right: 10px;
			cursor: pointer;
			transition: all .25s ease;
			transform: rotate(45deg);
		}
		.arrow.active {
			transform: rotate(135deg);
			margin-bottom: 3px;
		}

		#tabSiteLists .imgIcon, #tabSiteGroups .imgIcon { vertical-align:bottom; margin-right:4px; cursor:help; }
		#tabSiteGroups tbody td { vertical-align:top; }
		#tabSubsites tbody td:nth-child(1) { min-width: 250px; }
		#tabSubsites tbody td:nth-child(3) { white-space: nowrap; }
		#tabSubsites tbody td:nth-child(4) { white-space: nowrap; }
		.showHidn a, .showHidn a:visited { color:aaa; }

		#navtabSite #boxInfo { margin-bottom: 20px; }
		#navtabSite #boxInfo > div { vertical-align: top; }
		#navtabSite #boxInfo span { font-family: Roboto; font-size: 22px; }
		#navtabSite #boxOpts { flex-wrap:wrap; }
		#navtabSite #boxOpts > div { white-space: nowrap; }
		#navtabSite #boxOpts > div > span { margin-right:5px; vertical-align:middle; }
		.contSwitch { display:inline-block; vertical-align:middle; }
		#navtabSite #DateCre, #navtabSite #DateMod { white-space: nowrap; }

		.iconYes {
			width:  32px; min-width:  32px;
			height: 32px; min-height: 32px;
			background: url('data:image/png;base64,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');
		}
		.iconFail {
			width:  32px; min-width:  32px;
			height: 32px; min-height: 32px;
			background: url('data:image/png;base64,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');
		}
		.iconInfo {
			width:  32px; min-width:  32px;
			height: 32px; min-height: 32px;
			background: url('data:image/png;base64,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');
		}
		.iconQues {
			width:  32px; min-width:  32px;
			height: 32px; min-height: 32px;
			background: url('data:image/png;base64,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');
		}

		/* FLEXBOX TABS */
		.flexTabs {
			width: 100%;
			margin: 20px 0 10px 0;
			border: 1px solid #d5d5d5;
			box-shadow: 0px 4px 10px -5px rgba(0,0,0,0.5);
			border-radius: 5px;
		}
		.flexTabs > ul {
			display: flex;
			flex-wrap: wrap;
			list-style-type: none;
			background: #FAFAFA;
			margin: 0 !important; -webkit-margin-before: 0;  -moz-margin-before: 0;  -ms-margin-before: 0;
			padding: 0 !important;
			border-bottom: 1px solid #d5d5d5;
			border-radius: 5px 5px 0 0;
		}
		.flexTabs > ul > li {
			flex: 1 1 auto;
			cursor: pointer;
			text-shadow: 2px 2px #efefef;
			text-align: center;
			white-space: nowrap;
			display: inline-block; list-style-type:none;
			padding: 15px 10px;
			font-size: 14px;
			color: #a7a7a7;
			text-transform: uppercase;
			border-bottom: 3px solid #FAFAFA;
			-webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;
		}
		.flexTabs > ul > li.active {
			font-weight: bold;
			text-shadow: none;
			color: #0088CC;
			border-bottom: 3px solid #0088cc;
		}
		.flexTabs > div {
			display: none;
			margin: 0;
			padding: 20px;
			background: white;
			border-radius: 0 0 5px 5px;
		}
		.flexTabs > div.active { display: block; }
		.flexTabs > div > .subTitle:first-child { margin-top: 0; }
		.flexTabs > p { font-size: 14px; margin-bottom: 15px; }

		.flex {
			display: flex;
			flex-wrap: nowrap;
			margin-bottom: 20px;
		}
		.flex > div {
			flex: 1 1 auto;
			text-align: left;
		}
		.modernFlex {
			display: flex;
			flex-wrap: nowrap;
			margin-bottom: 20px;
			color: rgb(0,149,221);
			background: rgb(242,249,252);
			border: 1px #e7e7f7 solid;
			/*border-radius: 5px;*/
		}
		.modernFlex > div {
			flex: 1 1 auto;
			padding: 10px 20px;
			text-align: center;
			vertical-align: middle;
		}

		div.divTable { display: table; box-sizing: border-box; width: 100%; font-size: 12px; }
		div.divTable > div { display: table-cell; padding:10px; vertical-align: top; }
		div.divTable .subTitle { margin: 0 0 10px 0; }
		div.divTable label { display: block; margin-bottom: 3px; color:#bcbcbc; }

		/*-*/
		div.divTableRows { display:table; box-sizing:border-box; width:100%; font-size:12px; border: 1px solid #d7e7f7; }
		div.divTableRows > div { display: table-row; }
		div.divTableRows > div > div { display: table-cell; padding: 5px 10px; vertical-align: middle; background: #f2f9fc; }

		/* */
		#navtabDbug .divTableRows {
			min-width: 200px;
			font-size: 14px;
			border: 1px solid #d7e7f7;
		}
		#navtabDbug .divTableRows > div > div { padding: 10px 15px; background: #f2f9fc; }
		#navtabDbug .divTableRows > div > div:first-child { width:1%; }

		/*-*/
		.flatBtn {
			display: inline-block;
			font-size: 12px !important;
			color: #ffffff !important;
			border: 0 !important;
			padding: 10px;
			margin: 0;
			white-space: nowrap;
			text-decoration: none;
			text-transform: uppercase;
			border-radius: 4px;
			box-sizing: border-box;
			cursor: pointer;
			box-shadow: 0 2px 0 #c7c7c7;
			-webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;
		}
		.flatBtn.small {
			padding: 5px 10px !important;
			font-size: 11px !important;
			box-shadow: none;
		}
		.flatBtn.shadow {
			box-shadow: 0 2px 5px 0 rgba(0,0,0,0.4) !important; /* new, fall 2013 */
		}
		.flatBtn-blueDk,   .flatBtn-blueDk:hover	{ background-color: #1A76A5 !important; }
		.flatBtn-blueMd,   .flatBtn-blueMd:hover	{ background-color: #199FD2 !important; }
		.flatBtn-blueLt,   .flatBtn-blueLt:hover	{ background-color: #41B2DC !important; }
		.flatBtn-red,      .flatBtn-red:hover		{ background-color: #DB2814 !important; }
		.flatBtn-orange,   .flatBtn-orange:hover	{ background-color: #E78733 !important; }
		.flatBtn-greenLt,  .flatBtn-greenLt:hover	{ background-color: #7AB800 !important; }
		.flatBtn-green,    .flatBtn-green:hover		{ background-color: #27AE60 !important; }
		.flatBtn-purple,   .flatBtn-purple:hover	{ background-color: #9B59B6 !important; }
		.flatBtn-purpleDk, .flatBtn-purpleDk:hover	{ background-color: #8F44AD !important; }
		.flatBtn-gray,     .flatBtn-gray:hover		{ background-color: #BBBBBB !important; }
		.flatBtn-grayLt,   .flatBtn-grayLT:hover	{ background-color: #DDDDDD !important; }
		.flatBtn-nsTeal,	.flatBtn-nsTeal:hover	{ background-color: #1ABC9C !important; }
		.flatBtn-nsBlue,	.flatBtn-nsBlue:hover	{ background-color: #3498DB !important; }
		.flatBtn-nsPurple,	.flatBtn-nsPurple:hover	{ background-color: #9B59B6 !important; }
		.flatBtn-nsDark,	.flatBtn-nsDark:hover	{ background-color: #34495E !important; }
		.flatBtn-nsYellow,	.flatBtn-nsYellow:hover	{ background-color: #F1C40F !important; }
		.flatBtn-nsOrange,	.flatBtn-nsOrange:hover	{ background-color: #E67E22 !important; }
		.flatBtn-nsRed,		.flatBtn-nsRed:hover	{ background-color: #E74C3C !important; }
		.flatBtn-nsBlueLt,	.flatBtn-nsBlueLt:hover	{ background-color: #1FA6D5 !important; }
		.flatBtn-nsBlueVL,	.flatBtn-nsBlueVL:hover	{ background-color: #93d4eb !important; }
		.flatBtn-nsGrayVL,	.flatBtn-nsGrayVL:hover	{ background-color: #e6e6e6 !important; color: #b7b7b7 !important; }
		.flatBtn-modTeal,   .flatBtn-modTeal:hover  { background-color: #64C8D7 !important; }
		.flatBtn-modGray,   .flatBtn-modGray:hover  { background: linear-gradient(#fcfcfc, #eee) !important; color:#999 !important; border:1px solid #d5d5d5 !important; }

		/* ===== */
		.modernTable {
			display: table;
			width: 100%;
			padding: 0;
			color: rgb(0,149,221);
			background: rgb(242,249,252);
			border: 1px #e7e7f7 solid;
			border-radius: 5px;
			box-sizing: border-box;
		}
		.modernTable > div {
			display: table-cell;
			padding: 10px 0 10px 20px;
			vertical-align: middle;
		}
		.modernTable > div:last-child {
			padding-right: 20px;
		}
		.modernTable div select {
			width: 100%;
		}
		div.modernTable div.cellTitle, .modernTable div.cellTitle {
			font-size: 16px;
			margin: -2px 0 4px 0;
			white-space: nowrap;
		}
		.modernTable label {
			display: block;
			white-space: nowrap;
			text-transform: uppercase;
			color: #bfcfdf;
			font-size: 11px;
			margin-bottom: 3px;
		}
		.modernTable .size { text-align: right; padding-right: 20px !important; }

		/* sprestlib.css */
		.sprlib-spinner { display: block; text-align: center; height: 16px; }
		.sprlib-spinner > div {
			display: inline-block;
			animation: sprlib-sk-bouncedelay 1.4s infinite ease-in-out both;
			width:16px; height:16px;
			background-color: #40b0df; border-radius: 100%; border: 3px solid #f2f9fc;
		}
		.sprlib-spinner .sprlib-bounce1 { animation-delay: -0.32s; }
		.sprlib-spinner .sprlib-bounce2 { animation-delay: -0.16s; }
		@keyframes sprlib-sk-bouncedelay { 0%, 80%, 100% {  transform: scale(0); } 40% { transform: scale(1.0); } }

		/* tablesorter.css */
		.tablesorter thead th {
			border-left: 1px white solid !important;
			border-right: 1px white solid !important;
			border-top: 1px #e7e7f3 solid !important;
			border-bottom: 1px #e7e7f3 solid !important;
		}
		.tablesorter thead th:first-child { border-left:  1px #e7e7f3 solid !important; }
		.tablesorter thead th:last-child  { border-right: 1px #e7e7f3 solid !important; }
		.tablesorter thead .header {
			background-repeat: no-repeat;
			background-position: right 8px center;
			cursor: pointer;
		}
		.tablesorter thead .header         { background-color:#E5F2FA !important; color:#0090C0 !important; background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAKElEQVR42mNgQAYTDvxnwApAEjCMUwJFATYJrCbgtYtoo4lzLQ5/AgB5EEnhsdUsjwAAAABJRU5ErkJggg==') !important; }
		.tablesorter thead .headerSortDown { background-color:#a9d4ef !important; color:#ffffff !important; background-image:url('data:image/gif;base64,R0lGODlhBwAEAIAAAP///////yH5BAEAAAEALAAAAAAHAAQAAAIHjGEJq8sOCwA7') !important; }
		.tablesorter thead .headerSortUp   { background-color:#a9d4ef !important; color:#ffffff !important; background-image:url('data:image/gif;base64,R0lGODlhBwAEAIAAAP///////yH5BAEAAAEALAAAAAAHAAQAAAIIhA+BGWoNWSgAOw') !important; }
		.tablesorter > tbody > tr > td { border: 1px #F1F1F1 solid !important; color:#696969 !important; }
		/* tablesorter - Make room for sort icons */
		.tablesorter > thead > tr > th { padding: 6px 20px 6px 8px !important; }
		.tablesorter > thead > tr > th.sorter-false { padding: 6px 8px !important; cursor: default; }
		.tabModern > thead > tr > th.sorter-false { background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7') !important; }
		/* icon.checkbox cells in tbody */
		.tablesorter > tbody > tr > td.icon {
			width: 1%;
			background: #f8fbff;
			text-align: center;
			white-space: nowrap;
			border-top:1px solid #fff !important;
			border-bottom:1px solid #fff !important;
			padding: 0 4px;
			vertical-align: middle;
		}
		.tablesorter > tbody > tr > td.icon:last-child { border-bottom: 1px solid #F1F1F1; }

		/* tabModern */
		.tabModern {
			width: 100%;
			border-collapse: collapse;
			margin: 0px;
			font-size: 12px;
		}
		.tabModern > tbody > tr > th, .tabModern > tbody > tr > td { border: 1px #f1f1f1 solid; }
		.tabModern th.icon {
			width: 1%;
			padding: 0 4px;
		}
		.tabModern td.icon {
			width: 1%;
			padding: 0 4px 0 0;
			background: #f8fbff;
		}
		.tabModern > thead > tr > th {
			background: #E5F2FA;
			border-left: 1px white solid;
			border-bottom: 1px white solid;
			border-top: 1px #e7e7f3 solid;
			text-align: left;
			padding: 8px;
			font-size: 11px;
			font-weight: normal;
			color: #0090C0;
			text-transform: uppercase;
			white-space: nowrap;
			vertical-align: middle;
		}
		.tabModern > thead > tr > th.title {
		    background: #0088cc;
		    text-align: center;
		    padding: 10px;
		    color: white;
		    font-size: 14px;
		    font-weight: bold;
		}
		.tabModern > thead > tr > th:first-child {
			border-left: 1px #e7e7f3 solid;
		}
		.tabModern > thead > tr > th:last-child {
			border-right: 1px #e7e7f3 solid;
		}
		.tabModern > tbody > tr > th {
			vertical-align: top;
			font-weight: normal;
			text-align: left;
			padding: 8px 10px;
			background: #f2f9fc;
			color: #0088cc;
			border-bottom: 1px solid white !important;
		}
		.tabModern > tbody > tr > td {
			vertical-align: top;
			text-align: left;
			padding: 8px 10px;
			background: white;
			box-sizing: border-box;
		}
		.tabModern > tbody > tr > td > a:link {
			text-decoration: underline;
		}
		.tabModern > tfoot > tr > td { padding: 15px; text-align: center; }
		.tabModern > tbody > tr > th > div { font-weight: normal; }
		.tabModern td.gray { background: #f7f7f7; }
		.tabModern td.blue { background: #E5F2FA; }
		.tabModern th.tabModernSection, .tabModern td.tabModernSection {
			background: #E5F2FA !important;
			text-align: center !important;
			padding: 8px !important;
			color: #0F5199;
		}
		.tabModern.shadow { box-shadow:2px 2px 6px 2px #aaa; }
		/* ----- */
		td.code   { font-family: 'Inconsolata','Roboto Mono',monospace !important; white-space: pre !important; }
		td.fixed  { font-family: 'Inconsolata','Roboto Mono',monospace !important; white-space: nowrap !important; }
		td.right  { padding-right: 20px !important; text-align: right !important; }
		td.nowctr { white-space: nowrap !important; text-align: center !important; }
		td.nowrap { white-space: nowrap !important; }
		/* ----- */
		#tabSiteLists thead th:first-child { min-width:200px; }
		.showDesc { color:#a7a7a7; margin-top:5px; font-size:11px; }
		/* ----- */
		.switch { width: 28px; height: 16px; position: relative; display: inline-block; }
		.switch input { display:none; }
		.slider {
		  position: absolute;
		  cursor: pointer;
		  top: 0; left: 0; right: 0; bottom: 0;
		  background-color: #c7c7c7;
		  transition: .4s; -webkit-transition: .4s;
		}
		.slider:before {
		  position: absolute;
		  content: "";
		  height: 14px; width: 14px;
		  left: 1px; bottom: 1px;
		  background-color: white;
		  transition: .4s; -webkit-transition: .4s;
		}
		input:focus   + .slider { box-shadow: 0 0 1px #7fb0d2; }
		input:checked + .slider { background-color: #7fb0d2; }
		input:checked + .slider:before { -webkit-transform:translateX(12px); -ms-transform:translateX(12px); transform:translateX(12px); }
		.slider.round { border-radius: 14px; }
		.slider.round:before { border-radius: 50%; }
	</style>

	<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.29.0/js/jquery.tablesorter.min.js"></script>
	<script type="text/javascript" src="https://cdn.rawgit.com/gitbrent/SpRestLib/v1.2.0/dist/sprestlib.bundle.js"></script>
	<!-- NOTE: If you cant/wont use CDNs, simply uncomment the lines below and comment the CDN lines above -->
	<!--
	<script type="text/javascript" src="../SiteAssets/js/jquery.min.js"></script>
	<script type="text/javascript" src="../SiteAssets/js/jquery.tablesorter.min.js"></script>
	<script type="text/javascript" src="../SiteAssets/js/sprestlib.bundle.js"></script>
	-->

	<script type="text/javascript">
		// JQUERY
		$.ajaxSetup({ cache:false });
		// APP
		const APP_VER = '1.0.0';
		const APP_REL = '20171011';
		// CONSTANTS: UI/LOGIC
		const HTML_SPINNER = '<div class="sprlib-spinner"><div class="sprlib-bounce1"></div><div class="sprlib-bounce2"></div><div class="sprlib-bounce3"></div></div>';
		const STR_EMPTY = '<span style="color:#ccc; font-style:italic;">(empty)</span>';
		const MONTHS = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
		// CONSTANTS: APP
		const MODE_VERBOSE = window.location.href.toLowerCase().indexOf('mode=verbose') > -1; if (MODE_VERBOSE) { console.log('*** VERBOSE MODE ***'); }
		const MAXSITES = 50;
		// REF: (`SP.ListTemplateType`) https://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splisttemplatetype.aspx
		const SP_LIST_TEMPLATE_TYPES = {
			 '-1': {name:'InvalidType', desc:'Not used'},
			'100': {name:'GenericList', desc:'Custom list'},
			'101': {name:'DocumentLibrary', desc:'Document library'},
			'102': {name:'Survey', desc:'Survey'},
			'103': {name:'Links', desc:'Links'},
			'104': {name:'Announcements', desc:'Announcements'},
			'105': {name:'Contacts', desc:'Contacts'},
			'106': {name:'Events', desc:'Calendar'},
			'107': {name:'Tasks', desc:'Tasks'},
			'108': {name:'DiscussionBoard', desc:'Discussion board'},
			'109': {name:'PictureLibrary', desc:'Picture library'},
			'110': {name:'DataSources', desc:'Data sources for a site'},
			'111': {name:'WebTemplateCatalog', desc:'Site template gallery'},
			'112': {name:'UserInformation', desc:'User Information'},
			'113': {name:'WebPartCatalog', desc:'Web Part gallery'},
			'114': {name:'ListTemplateCatalog', desc:'List template gallery'},
			'115': {name:'XMLForm', desc:'XML Form library'},
			'116': {name:'MasterPageCatalog', desc:'Master Page gallery'},
			'117': {name:'NoCodeWorkflows', desc:'No Code Workflows'},
			'118': {name:'WorkflowProcess', desc:'Custom Workflow Process'},
			'119': {name:'WebPageLibrary', desc:'Wiki Page Library'},
			'120': {name:'CustomGrid', desc:'Custom grid for a list'},
			'121': {name:'SolutionCatalog', desc:'Solutions'},
			'122': {name:'NoCodePublic', desc:'No Code Public Workflow'},
			'123': {name:'ThemeCatalog', desc:'Themes'},
			'124': {name:'DesignCatalog', desc:'DesignCatalog'},
			'125': {name:'AppDataCatalog', desc:'AppDataCatalog'},
			'126': {name:'AppFiles', desc:'App Files'},
			'130': {name:'DataConnectionLibrary', desc:''},
			'140': {name:'WorkflowHistory', desc:'Workflow History'},
			'150': {name:'GanttTasks', desc:'Project Tasks'},
			'151': {name:'HelpLibrary', desc:'Help Library'},
			'160': {name:'AccessRequest', desc:'Tasks with Timeline and Hierarchy'},
			'171': {name:'TasksWithTimelineAndHierarchy', desc:'Tasks with Timeline and Hierarchy'},
			'175': {name:'MaintenanceLogs', desc:'Maintenance Logs Library'},
			'200': {name:'Meetings', desc:'Meeting Series (Meeting)'},
			'201': {name:'Agenda', desc:'Agenda (Meeting)'},
			'202': {name:'MeetingUser', desc:'Attendees (Meeting)'},
			'204': {name:'Decision', desc:'Decisions (Meeting)'},
			'207': {name:'MeetingObjective', desc:'Objectives (Meeting)'},
			'210': {name:'TextBox', desc:'Text Box (Meeting)'},
			'211': {name:'ThingsToBring', desc:'Things To Bring (Meeting)'},
			'212': {name:'HomePageLibrary', desc:'Workspace Pages (Meeting)'},
			'301': {name:'Posts', desc:'Posts (Blog)'},
			'302': {name:'Comments', desc:'Comments (Blog)'},
			'303': {name:'Categories', desc:'Categories (Blog)'},
			'402': {name:'Facility', desc:'Facility'},
			'403': {name:'Whereabouts', desc:'Whereabouts'},
			'404': {name:'CallTrack', desc:'Call Track'},
			'405': {name:'Circulation', desc:'Circulation'},
			'420': {name:'Timecard', desc:'Timecard'},
			'421': {name:'Holidays', desc:'Holidays'},
			'499': {name:'IMEDic', desc:'IME (Input Method Editor) Dictionary'},
			'544': {name:'MicroFeed', desc:'MySite MicroFeed Persistent Storage List'},
			'600': {name:'ExternalList', desc:'External List'},
			'700': {name:'MySiteDocumentLibrary', desc:'My Site Document Library'},
			'701': {name:'?', desc:'CustomDocumentLibrary?'},
			'1100': {name:'IssueTracking', desc:'Issue tracking'},
			'1200': {name:'AdminTasks', desc:'Administrator Tasks'},
			'1220': {name:'HealthRules', desc:'Health Rules'},
			'1221': {name:'HealthReports', desc:'Health Reports'},
			'1230': {name:'DeveloperSiteDraftApps', desc:'Draft Apps library in Developer Site'},
			'3300': {name:'SharingLinks', desc:'Use this list to track documents which have internal or anonymous sharing links in the site'},
			'4501': {name:'wfsvc', desc:'wfsvc'},
			'110102': {name:'ConvertedForms', desc:'List of user browser-enabled form templates on this site collection'}
		};
		// REF: (`SP.Utilities.PrincipalType`) https://msdn.microsoft.com/en-us/library/ee553710(v=office.14).aspx
		const SP_PRINCIPLE_TYPES = {
			 '0' : {name:'none', desc:'None'},
			 '1' : {name:'user', desc:'User'},
			 '2' : {name:'distributionList', desc:'Distribution List'},
			 '4' : {name:'securityGroup', desc:'Security Group'},
			 '8' : {name:'sharePointGroup', desc:'SharePoint Group'},
			 '15': {name:'all', desc:'All'}
		 };
		// GLOBAL VARS
		var gObjMapNameToId = {};
		var gObjSubsites = {};
		// TODO: I18N internationalization ('Y' etc)
		// https://docs.microsoft.com/en-us/sharepoint/dev/sp-add-ins/sharepoint-net-server-csom-jsom-and-rest-api-index
		// works: _spPageContextInfo.webAbsoluteUrl

		// ==================================================================================================================

		// Helpers
		{
			/**
			 * Return a JS Date object adjusted for local machine Timezone
			 * NOTE: This function ASSUMES times passed to it are in GMT!
			 *
			 * @param {string} inStrDate: SP date format (eg: '2016-08-08T18:21:18Z')
			 * @param {string} inType:    Format style ['US', 'DATE', 'YYYYMMDD', 'INTLTIME', 'INTL', 'ISO']
			 */
			function getDateStrFromISO(inStrDate, inType){
				// REALITY-CHECK:
				if ( inStrDate == null ) return '';
				if ( typeof inStrDate !== 'string' ) { throw('getDateStrFromISO: bad date'); }

				var strFinalDate = "";
				var dtcomps = inStrDate.replace(/\D/g," ").split(" ");
				dtcomps[1]--;
				var dateLocal = new Date(Date.UTC(dtcomps[0],dtcomps[1],dtcomps[2],dtcomps[3],dtcomps[4],dtcomps[5]));
				var dateMM = dateLocal.getMonth() + 1; var dateDD = dateLocal.getDate(); var dateYY = dateLocal.getFullYear();
				var h = dateLocal.getHours(); var m = dateLocal.getMinutes(); var s = dateLocal.getSeconds();
				//
				if (inType == "US") {
					strFinalDate = (dateMM<=9 ? '0' + dateMM : dateMM) + "/" + (dateDD<=9 ? '0' + dateDD : dateDD) + "/" + dateYY
							+ " " + (h<=9 ? '0' + h : h) + ":" + (m<=9 ? '0' + m : m) + ":" + (s<=9 ? '0' + s : s);
				}
				else if (inType == "DATE") {
					strFinalDate = (dateMM<=9 ? '0' + dateMM : dateMM) + "/" + (dateDD<=9 ? '0' + dateDD : dateDD) + "/" + dateYY;
				}
				else if (inType == "TIME") {
					strFinalDate = (h<=9 ? '0' + h : h) + ":" + (m<=9 ? '0' + m : m) + ":" + (s<=9 ? '0' + s : s);
				}
				else if (inType == "YYYYMMDD") {
					strFinalDate = dateYY +"-"+ (dateMM<=9 ? '0' + dateMM : dateMM) +"-"+ (dateDD<=9 ? '0' + dateDD : dateDD) + " "
							+ (h<=9 ? '0' + h : h) + ":" + (m<=9 ? '0' + m : m) + ":" + (s<=9 ? '0' + s : s);
				}
				else if (inType == "INTLTIME") {
					strFinalDate = MONTHS[dateLocal.getMonth()] + " " + (dateDD<=9 ? '0' + dateDD : dateDD) + ", " + dateYY + " "
							+ (h<=9 ? '0' + h : h) + ":" + (m<=9 ? '0' + m : m) + ":" + (s<=9 ? '0' + s : s);
				}
				else if (inType == "INTL") {
					strFinalDate = MONTHS[dateLocal.getMonth()] + " " + (dateDD<=9 ? '0' + dateDD : dateDD) + ", " + dateYY;
				}
				else if (inType == "ISO") {
					// EX: 2016-05-05T15:27:02.893Z
					strFinalDate = dateYY +"-"+ (dateMM<=9 ? '0' + dateMM : dateMM) +"-"+ (dateDD<=9 ? '0' + dateDD : dateDD)
								+"T"+ (h<=9 ? '0' + h : h) + ":" + (m<=9 ? '0' + m : m) + ":" + (s<=9 ? '0' + s : s) + ".000Z";
				}

				if ( strFinalDate && (strFinalDate.indexOf("NaN") > -1 || strFinalDate.indexOf("undefined") > -1) ) return '';
				return strFinalDate;
			}

			/**
			 * Push table data to client as csv file.
			 */
			function exportTabData(inTabName) {
				var data = '';
		        var filename = 'sprLibToolkit_export_'+ new Date().toISOString().split('.')[0].replace(/\D/g,'') +'.csv';

				// STEP 1: Compile data
				$('#'+inTabName+' tr').each(function(idx,row){
					$(row).find('th,td').each(function(idy,cell){ data += '"'+ $(cell).text().trim() + '",'; });
					data = data.substring(0,data.length-1) + '\n';
				});

				// STEP 2: Export
				var blob = new Blob([data], {type: "text/csv;charset=utf-8;"});
				if ( navigator.msSaveBlob ) {
					navigator.msSaveBlob(blob, filename);
				}
				else {
					var link = document.createElement("a");
					var url = URL.createObjectURL(blob);
					link.setAttribute("href", url);
					link.setAttribute("download", filename);
					link.style = "visibility:hidden";
					document.body.appendChild(link);
					link.click();
					document.body.removeChild(link);
				}
		    }
		}

		// ==================================================================================================================

		function popSiteInfo() {

			// TODO: add "who gets reqs"
			// sprLib.rest({ url:'_api/web/RequestAccessEmail' }).then(arr => console.table(arr));

			// PERF: Query all site info now
			Promise.all([
				sprLib.rest({
					url: '_api/web',
					queryCols: ['Title','Description','Url','Created','LastItemModifiedDate','SiteLogoUrl'],
					queryLimit: MAXSITES
				}),
				sprLib.rest({
					url: '_api/site/usage',
					queryCols: ['Usage/Storage','Usage/StoragePercentageUsed']
				}),
				sprLib.rest({
					url: '_api/web/lists',
					queryCols: ['Id','Title','BaseTemplate','BaseType','Created','Description','EnableAttachments','ImageUrl',
						'EnableVersioning','EntityTypeName','ForceCheckout','Hidden','ItemCount','LastItemModifiedDate','RootFolder/ServerRelativeUrl'],
					queryLimit: 5000
				}),
				sprLib.rest({
					url: '_api/Web/SiteGroups',
					queryCols: ['Id','Title','OwnerTitle','Description','PrincipalType','AllowMembersEditMembership'],
					queryLimit: 1000
				}),
				sprLib.rest({
					url: '_api/Web/RoleDefinitions',
					queryCols: ['Id','Name','Description','RoleTypeKind'],
					queryFilter: 'Hidden ne true',
					queryLimit: 1000
				}),
				sprLib.rest({
					url: '_api/web/webs',
					queryCols: {
						Id:				{ dataName:'Id'						,dispName:'Id'					},
						Name:			{ dataName:'Title'					,dispName:'Subsite Name'		},
						Url:			{ dataName:'Url'					,dispName:'Site Url'			},
						Created:		{ dataName:'Created'				,dispName:'Date Created'		},
						Modified:		{ dataName:'LastItemModifiedDate'	,dispName:'Date Last Modified'	},
						Language:		{ dataName:'Language'				,dispName:'Language'			},
						IsMultilang:	{ dataName:'IsMultilingual'			,dispName:'Is Multilingual?'	},
					}
				})
			])
			.then(arrAllArrays => {
				// STEP 1: Dereference query results
				var arrSite     = arrAllArrays[0];
				var arrUsage    = arrAllArrays[1];
				var arrLists    = arrAllArrays[2];
				var arrGroups   = arrAllArrays[3];
				var arrRoles    = arrAllArrays[4];
				var arrSubsites = arrAllArrays[5];

				// SHOW: Site info
				{
					// A:
					if (MODE_VERBOSE) { console.log('arrSite[0]:'); console.table(arrSite[0]); }

					// B: Show site info
					if ( arrSite[0].SiteLogoUrl ) $('#siteLogo').prop('src', arrSite[0].SiteLogoUrl);
					else $('#siteLogo').hide().parent('div').css('padding','0').css('width','1px');
					$('#SiteName').html( arrSite[0].Title || STR_EMPTY );
					$('#DateCre').text( getDateStrFromISO(arrSite[0].Created,'INTL') );
					$('#DateMod').text( getDateStrFromISO(arrSite[0].LastItemModifiedDate,'INTL') );
				}

				// SHOW: Usage
				{
					// A:
					if (MODE_VERBOSE) { console.log('arrUsage[0]:'); console.table(arrUsage[0]); }

					// B: Show usage
					$('#UsageTot').text( (arrUsage[0].Usage.Storage / (1024*1024*1024)).toFixed(2) +' GB');
					$('#UsagePct').text( (arrUsage[0].Usage.StoragePercentageUsed * 100).toFixed(2) +'%');
				}

				// SHOW: Lists/Libraries
				{
					// A:
					if (MODE_VERBOSE) { console.log('arrLists:'); console.table(arrLists); }

					// B:
					arrLists.forEach((list,idx)=>{
						// B-1: Populate table
						{
							let $row = $('<tr data-list-id="'+list.Id+'" class="'+ (list.Hidden ? 'showHidn' : '') +'" style="'+ (list.Hidden && !$('#chkHidn').prop('checked') ? 'display:none' : '') +'"></tr>');
							$row.append('<th><img class="imgIcon" src="'+ list.ImageUrl +'" title="'+ (SP_LIST_TEMPLATE_TYPES[list.BaseTemplate] ? SP_LIST_TEMPLATE_TYPES[list.BaseTemplate].desc : '') +'">'
								+ '<a href="'+ list.RootFolder.ServerRelativeUrl +'" target="_blank">'+ list.Title +'</a>'
								+ (list.Description ? '<div class="showDesc"><span style="display:none">: </span>'+ list.Description +'</div>' : '')
								+ '</th>'
							);
							$row.append('<td>'+ (list.BaseType == 0 ? 'List' : 'Library') +'<span class="showTemp" style="display:none"> ('+ (SP_LIST_TEMPLATE_TYPES[list.BaseTemplate] ? SP_LIST_TEMPLATE_TYPES[list.BaseTemplate].name : list.BaseTemplate) +')</span></td>');
							// TODO: showDate sort broken after show/hide
							$row.append('<td class="nowctr showDate">'+ getDateStrFromISO(list.Created,'INTL') +'</td>');
							$row.append('<td class="nowctr showDate">'+ getDateStrFromISO(list.LastItemModifiedDate,'INTL') +'</td>');
							$row.append('<td class="nowctr">'+ list.ItemCount +'</td>');
							$row.append('<td class="nowctr showFeat">'+ (list.EnableAttachments ? 'Y' : '') +'</td>');
							$row.append('<td class="nowctr showFeat">'+ (list.EnableVersioning  ? 'Y' : '') +'</td>');
							$row.append('<td class="nowctr showFeat">'+ (list.ForceCheckout     ? 'Y' : '') +'</td>');

							$row.append('<td class="showPerm" data-perm-name="Full Control"></td>');
							$row.append('<td class="showPerm" data-perm-name="Design"></td>');
							$row.append('<td class="showPerm" data-perm-name="Edit"></td>');
							$row.append('<td class="showPerm" data-perm-name="Contribute"></td>');
							$row.append('<td class="showPerm" data-perm-name="Read/View"></td>');
							$row.append('<td class="showPerm" data-perm-name="Approve"></td>');

							$('#tabSiteLists tbody').append( $row );
						}

						// B-2: Fetch/Pop List Permissions
						sprLib.rest({
							url: "_api/lists/getbytitle('"+list.Title+"')/RoleAssignments",
							queryCols: ['Member/Title','RoleDefinitionBindings/Name','RoleDefinitionBindings/Hidden']
						})
						.then(arr=>{
							arr.forEach((prin,idx)=>{
								let arrPerms = [];
								prin.RoleDefinitionBindings.forEach((perm,idx)=>{
									//if (!perm.Hidden) arrPerms.push(perm.Name)
									if ( !perm.Hidden ) {
										perm.Name = perm.Name.replace('Read','Read/View').replace('View Only','Read/View');

										if ( $('#tabSiteLists tr[data-list-id="'+list.Id+'"] td[data-perm-name="'+ perm.Name +'"]').length > 0 ) {
											$('#tabSiteLists tr[data-list-id="'+list.Id+'"] td[data-perm-name="'+ perm.Name +'"]').append( prin.Member.Title );
										}
										else {
											$('#tabSiteLists thead tr:first-child th:last-child').prop('colspan',Number($('#tabSiteLists thead tr:first-child th:last-child').prop('colspan'))+1);
											$('#tabSiteLists thead tr:last-child').append('<th class="showPerm">'+ perm.Name +'</th>');
											$('#tabSiteLists tbody tr').each((idx,row)=> $(row).append('<td data-perm-name="'+ perm.Name +'"></td>') );
											$('#tabSiteLists tr[data-list-id="'+list.Id+'"] td[data-perm-name="'+ perm.Name +'"]').append( prin.Member.Title );
										}
									}
								});
							});

							// Update tablesorter if needed
							// TODO: ???
							//if ( $('#tabSiteLists thead:last-child th:last-child').find('.header').length == 0 ) $('#tabSiteLists').trigger('update'); // TODO: does this work?
						});
					});

					// C: Honor view options
 					if ( !$('#chkDate').prop('checked') ) $('.showDate').hide();
					if ( !$('#chkFeat').prop('checked') ) $('.showFeat').hide();

					// D: tablesorter
					if ( $.tablesorter ) $('#tabSiteLists').tablesorter({ sortList:[[0,0]] });

					// E: Show total
					$('#LISTS').append('<span>('+ $('#tabSiteLists tbody tr').length +' total / '+ $('#tabSiteLists tbody tr.showHidn').length +' hidden)</span>');
				}

				// SHOW: Groups
				{
					// A:
					if (MODE_VERBOSE) { console.log('arrGroups:'); console.table(arrGroups); }

					// B: Populate Groups
					arrGroups.forEach(function(group,idx){
						// A-1: Create row
						let $row = $('<tr/>');
						$row.append('<th>'
							+ '<img class="imgIcon" src="/_layouts/15/images/ribbon_userprofile_16.png">'
							+ '<a href="../_layouts/15/people.aspx?MembershipGroupId='+ group.Id +'" target="_blank">'+ group.Title +'</a>'
							+ '</th>');
						$row.append('<td>'+ group.OwnerTitle +'</td>');
						$row.append('<td>'+ group.Description +'</td>');
						$row.append('<td id="groupUsers'+ group.Id +'"></td>');
						$('#tabSiteGroups tbody').append( $row );

						// A-2: Populate Group members
						sprLib.rest({
							url: '_api/web/SiteGroups('+ group.Id +')/Users',
							objCols: ['Id','Email','LoginName','PrincipleType','Title']
						})
						.then(arrUsers => {
							var strUsers = '';
							arrUsers.forEach(function(user,idx){ strUsers += ( (idx > 0 ? ', ' : '') + user.Title ); });
							$('#groupUsers'+group.Id).html( strUsers ? strUsers : STR_EMPTY );
						})
						.catch(strErr => $('#groupUsers'+group.Id).text(strErr||'?'));
					});

					// C: tablesorter
					if ( $.tablesorter ) $('#tabSiteGroups').tablesorter({ sortList:[[0,0]], headers:{2:{sorter:false},3:{sorter:false}} });

					// D: Show total
					$('#GROUPS').append('<span>('+ $('#tabSiteGroups tbody tr').length +')</span>');
				}

				// SHOW: Roles
				{
					if (MODE_VERBOSE) { console.log('arrRoles:'); console.table(arrRoles); }

					// B:
					arrRoles.forEach(function(role,idx){
						let $row = $('<tr/>');

						$row.append('<th><a href="../_layouts/15/editrole.aspx?role='+ role.Name +'" target="_blank">'+ role.Name +'</a></th>');
						$row.append('<td>'+ role.Description +'</td>');
						$row.append('<td class="nowctr">'+ role.Id +'</td>');

						$('#tabSiteRoles tbody').append( $row );
					});

					// C: tablesorter
					if ( $.tablesorter ) $('#tabSiteRoles').tablesorter({ sortList:[[0,0]] });

					// D: Show total
					$('#ROLES').append('<span>('+ $('#tabSiteRoles tbody tr').length +')</span>');
				}

				// SHOW: Subsites
				{
					if (MODE_VERBOSE) { console.log('arrSubsites:'); console.table(arrSubsites); }

					arrSubsites.forEach(function(site,idx){
						if (MODE_VERBOSE) { console.log('arrSubsites loop ('+idx+'): '+site.Name); }

						// A: Capture base subsite object
						gObjSubsites[site.Id] = site;

						// B: Create mapping so we can store usage results as they come back
						gObjMapNameToId[site.Name] = site.Id;

						// C: OTHER-DATA: Subsite Owner Group Id
						Promise.resolve()
						.then(() => {
							return sprLib.rest({ url:site.Url+'/_api/web/AssociatedOwnerGroup', objCols:'Id' });
						})
						.then(arrOwnerId => {
							if (MODE_VERBOSE) { console.log('arrOwnerId[0]:'); console.log(arrOwnerId[0]); }
							return sprLib.rest({ url:site.Url+'/_api/web/SiteGroups/GetById('+ arrOwnerId[0].Id +')/Users', queryCols:['Title','Email'] });
						})
						.then(arrGroups => {
							if (MODE_VERBOSE) { console.log('arrGroups:'); console.table(arrGroups); }
							site.GroupOwners = [];
							arrGroups.forEach((result,idx) => { site.GroupOwners += (result.Email ? result.Email+'; ' : ''); });
						});
					});
				}
			})
			.catch(strErr => console.error(strErr));
		}

		function getStorman() {
			var arriFrameLoads = [];
			// NOTE: Scraping storman is the only option! (no csom/jsom/rest API exists in SP2013/SP2016) - Load and scrape each storman page!
			var urlStormanBase = location.href.substring(0, location.href.toLowerCase().indexOf('sitepages/')).toLowerCase();

			// STEP 1: UI
			$('#tabSubsites tr.busy').show();

			// STEP 2: Create callbacks
			$('#scraper').on('load', function(){
				// TODO: Check for errors - page will load (read: $(scraper).error() isnt called), so check here - dont assumce everything is fine
				// TODO: "500 INTERNAL SERVER ERROR"
				if ( $('#scraper').contents().find('#onetidUserRptrTable').length > 0 ) {
					// A: How many storman pages are there? (EX: "(Page1/4)Next")
					// TODO: #I18N: We'll want to know what "Page" is in Simplified Chinese, etc. - dep. upon users lang
					var intPages = Number( $('#scraper').contents().find('#onetidUserRptrTable').next('table').find('tbody tr td').text().replace(/\s/gi,'').split('/')[1].split(')')[0] );

					// B: Load an iframe for each storman page, then parse
					// TODO: create/use MAXSITES - stop at like 50 (or 4 pages of storman)) in cases where sites are _huge_ we dont want to run iFrames for that amount or even loop - thats just too much work in principle.
					//for (var idx=0; idx<(intPages&&idx<MAXSITES); idx++) {
					for (var idx=0; idx<intPages; idx++) {
						arriFrameLoads.push('iframe'+idx);
						$('#scraper').after('<iframe id="iframe'+idx+'" class="jsTemp" src="" frameborder="0" width="1" height="1" style="display:none"></iframe>');
						$('#iframe'+idx).prop('src', urlStormanBase+'_layouts/15/storman.aspx?root=&OrderBy=0&Asc=0&Page='+idx);
						$('#iframe'+idx).on('load', function(){
							// A:
							var strCellSite = "", strCellUsed = "", strCellPrct = "";

							// B:
							$(this).contents().find('#onetidUserRptrTable tbody tr').each(function(i,row){
								strCellSite = $.trim( $(row).find('td:nth-child(2) a').text() );
								strCellUsed = $.trim( $(row).find('td:nth-child(3)  ').text() );
								strCellPrct = $.trim( $(row).find('td:nth-child(4)  ').text() );

								// Recalc all sizes to be MB
								strCellUsed.replace('< ', '').replace('<', '');
								if ( strCellUsed.indexOf('GB') > -1 ) {
									strCellUsed = (Number(strCellUsed.split(' ')[0]) * 1024).toFixed(1);
								}
								else if ( strCellUsed.indexOf('KB') > -1 ) {
									strCellUsed = (Number(strCellUsed.split(' ')[0]) / 1024).toFixed(1);
								}
								else {
									strCellUsed = strCellUsed.split(' ')[0];
								}

								if ( strCellSite && gObjMapNameToId[strCellSite] ) {
									gObjSubsites[ gObjMapNameToId[strCellSite] ].UsedSize = strCellUsed;
									gObjSubsites[ gObjMapNameToId[strCellSite] ].UsedPct  = strCellPrct;
								}
							});

							// C:
							arriFrameLoads.splice(arriFrameLoads.indexOf('iframe'+idx), 1);
							if ( arriFrameLoads.length == 0 ) showSiteInfo();
						});
					}
				}
				else {
					console.error('scraper didnt load');
				}
			});
			$('#scraper').on('error', function(){
				console.error('scraper didnt load');
			});

			// STEP 3: Load storman report
			$('#scraper').prop('src', urlStormanBase+'_layouts/15/storman.aspx?root=&OrderBy=0&Asc=0&Page=0');
		}

		function showSiteInfo() {
			// STEP 1: Clear UI
			$('#tabSubsites').trigger("destroy");
			$('#tabSubsites tbody').empty();
			$('#tabSubsites tr.busy').show();

			// STEP 2: Populate table
			$.each(gObjSubsites, function(id,site){
				var $row = $('<tr/>');

				$row.append('<td>'+ site.Name +'</td>');
				$row.append('<td><a href="'+site.Url+'">'+ site.Url.substring(site.Url.lastIndexOf('/')+1) +'</a></td>');
				$row.append('<td class="size">'+ site.UsedSize +'</td>');
				$row.append('<td class="center">'+ site.UsedPct +'</td>');
				$row.append('<td class="nowctr">'+ getDateStrFromISO(site.Created,'INTL') +'</td>');
				$row.append('<td class="nowctr">'+ getDateStrFromISO(site.Modified,'INTL') +'</td>');
				$row.append('<td class="dmyExcelWrap">'+ site.GroupOwners +'</td>');

				$('#tabSubsites tbody').append( $row );
			});

			// STEP 3: Hide busy
			$('#tabSubsites tr.busy').hide();

			// STEP 4: TableSorter
			if ( $.tablesorter ) $('#tabSubsites').tablesorter({ sortList:[[0,0]] }); // Sort by (Col#/Asc=0,Desc=1)
		}

		// ==================================================================================================================

		function handleListChange() {
			// A: Clear results
			$('#tabList-ListInfo table').remove();
			$('#tabList-ListCols table').remove();
			// B: Return if nothing selected
			if ( !$('#selSiteLists').val() ) return;

			// LIST INFO:
			$('#tabList-ListInfo pre code').text( 'sprLib.list(\''+ $('#selSiteLists').val() +'\').info()' );
			sprLib.list($('#selSiteLists').val()).info()
			.then(function(objInfo){
				var $table = $('<table><tbody></tbody></table>');
				Object.keys(objInfo).forEach(function(key,idx){
					$table.find('tbody').append('<tr><th>'+ key +'</th>'+'<td>'+ objInfo[key] +'</td></tr>');
				});
				$('#tabList-ListInfo').append( $table );
			})
			.catch(function(errMsg){
				$('$tabList-ListInfo .tableRows').after( '<table><tbody><tr><td>'+errMsg+'</td></tr></tbody></table>' );
			});

			// LIST COLS:
			$('#tabList-ListCols pre code').text( 'sprLib.list(\''+ $('#selSiteLists').val() +'\').cols()' );
			sprLib.list($('#selSiteLists').val()).cols()
			.then(function(arrColObjs){
				var $table = $('<table><thead><tr></tr></thead><tbody></tbody></table>');

				if ( arrColObjs.length ) $.each(arrColObjs[0],function(key,val){ $table.find('thead tr').append('<th>'+key+'</th>') });

				arrColObjs.forEach(function(obj,idx){
					let $row = $('<tr/>');
					$.each(obj,function(key,val){ $row.append('<td>'+val+'</td>') });
					$table.find('tbody').append( $row );
				});

				$('#tabList-ListCols').append( $table );
			})
			.catch(function(errMsg){
				$('$tabList-ListCols .tableRows').after( '<table><tbody><tr><td>'+errMsg+'</td></tr></tbody></table>' );
			});
		}

		// ==================================================================================================================

		function doPageLoad() {
			// STEP 1: HTML Setup
			document.title = "SharePoint SCA Toolkit";

			// STEP 2: UI Updates
			if ( location.href.toLowerCase().indexOf('mode=verbose') > -1 ) $('#navTabs > ul > li:first-child').show().click();

			// STEP 3: Populate tabs

			// TAB: Setup
			{
				// SP: Datetime Stamp
				$('#spDateTime').text( new Date().toLocaleString() );

				// JS.A: jQuery
				if ( typeof jQuery !== 'undefined' ) {
					$('#libChkJquery > div:first-child').append( '<div class="iconYes"></div>' );
					$('#libChkJquery > div:last-child').text( jQuery.fn.jquery );
				}
				else {
					$('#libChkJquery').append('oops - go check <script> tag ');
				}

				// JS.B: jQuery-tablesorter
				if ( typeof $.tablesorter !== 'undefined' ) {
					$('#libChkTsorter > div:first-child').append( '<div class="iconYes"></div>' );
					var baseUrl = sprLib.baseUrl();

					// Make human readable when relative directory returned
					if ( baseUrl == ".." ) {
						baseUrl = location.href.substring(0, location.href.lastIndexOf('/'));
						baseUrl = baseUrl.substring(0, baseUrl.lastIndexOf('/'));

						$('#spVersion').text( sprLib.version() );
					}
					$('#spBaseUrl').text( baseUrl );
				}
				else {
					$('#libChkTsorter').append('<div class="iconFail"></div><br>oops - go check <script> tag ');
				}

				// JS.C: SpRestLib
				if ( typeof sprLib !== 'undefined' ) {
					$('#libChkSprLib > div:first-child').append( '<div class="iconYes"></div>' );
					$('#libChkSprLib > div:last-child').text( sprLib.version() );

					// Make human readable when relative directory returned
					var baseUrl = sprLib.baseUrl();
					if ( baseUrl == ".." ) {
						baseUrl = location.href.substring(0, location.href.lastIndexOf('/'));
						baseUrl = baseUrl.substring(0, baseUrl.lastIndexOf('/'));

						$('#spVersion').text( sprLib.version() );
					}
					$('#spBaseUrl').text( baseUrl );
				}
				else {
					$('#libChkSprLib').append( '<div class="iconFail"></div><br>oops - go check <script> tag ' );
					$('#spBaseUrl').text( '(n/a)' );

					// Halt execution
					return;
				}

				// LAST: Remove loading images
				$('#navtabDbug .iconQues').remove();
			}

			// TAB: Site Info
			{
				$('#SiteName, #UsageTot, #UsagePct, #DateCre, #DateMod').html( HTML_SPINNER );
				popSiteInfo();
			}

			// TAB: Site Compare
			{
				/*
				// Populate <select> with List names
				sprLib.rest({ restUrl:'_api/web/lists?$select=Title&$filter=Hidden%20eq%20false' })
				.then(function(arrayListObjs){
					arrayListObjs
					.sort(function(a,b){return (a.Title > b.Title) ? 1 : ((b.Title > a.Title) ? -1 : 0);} )
					.forEach(function(obj,idx){ $('#selSiteLists').append('<option value="'+ obj.Title +'">'+ obj.Title +'</option>'); });
					$('#contListSelect .sprlib-spinner').remove();
				});
				*/
			}

			// TAB: Site Synchronize
			{
				/*
				var user1Code = "sprLib.user().info()\n"
					+ ".then(function(objUser){\n"
					+ "    $.each(objUser,function(key,val){\n"
					+ "        if (typeof val !== 'object') $('#user1Html table tbody').append('<tr><th>'+ key +'</th><td>'+ val +'</td></tr>');\n"
					+ "    });\n"
					+ '});';
				$('#user1Code pre code').text( user1Code );
				eval(user1Code);

				var user2Code = "sprLib.user().groups()\n"
					+ '.then(function(arrGroups){\n'
					+ "    arrGroups.forEach(function(objGroup,idx){\n"
					+ "        $('#user2Html table tbody').append('<tr><td>'+ objGroup.Id +'</td><td>'+ objGroup.Title +'</td></tr>');\n"
					+ "    });\n"
					+ '});';
				$('#user2Code pre code').text( user2Code );
				eval(user2Code);
				*/
			}
		}

		// ==================================================================================================================
		/*$(document).ready(function(){
			// Dynamically load library as SP Online is *BAD* abut caching
			$.getScript("/sites/dev/SiteAssets/js/sprestlib.js", function(){ doPageLoad(); });
		});*/
		window.onload = function(){ doPageLoad(); SetFullScreenMode(true); };
	</script>
</head>
<body>
	<iframe id="scraper" style="display:none"></iframe>

	<div id="divBody">
		<div id="titleBox" class="divTable">
			<div style="width:99%">
				<div class="bigTitle">SharePoint Site Collection Admin Toolkit</div>
				<div class="bigTitsu">Useful Tools for SharePoint Admins, Developers and SCAs.</div>
			</div>
			<div style="width:1%">
				<img id="siteLogo">
			</div>
		</div>

		<div id="navTabs" class="flexTabs">
			<ul>
				<li onclick="$('#navTabs').find('> div, li').removeClass('active'); $(this).addClass('active'); $('#navtabDbug').addClass('active');" style="display:none">Setup Check</li>
				<li onclick="$('#navTabs').find('> div, li').removeClass('active'); $(this).addClass('active'); $('#navtabSite').addClass('active');" class="active">Site Inventory</li>
				<li onclick="$('#navTabs').find('> div, li').removeClass('active'); $(this).addClass('active'); $('#navtabComp').addClass('active');">Site Compare</li>
				<li onclick="$('#navTabs').find('> div, li').removeClass('active'); $(this).addClass('active'); $('#navtabSync').addClass('active');">Site Synchronize</li>
			</ul>

			<div id="navtabDbug" data-tab="Debug/Setup/Verbose">
				<div class="subTitle">Welcome to Verbose Mode!</div>
				<div class="bigger">
					Lots of variables will be shown in the Console to better enable debubbing any issues you may be experiencing.
					<ul>
						<li>Did all of the external libraries shown below load successfully?</li>
						<li>Does the SP Config/Info look right?  Is your Site Collection location correct?</li>
						<li>Please check the <a href="https://github.com/gitbrent/SpRestLib">GitHub Project Site</a> for setup
						and configuration FAQs and full documentation.</li>
					</ul>
				</div>

				<div class="flex">
					<div data-name="col1" style="flex:1 1 auto; margin-right:50px;">
						<div class="subTitle">JavaScript Library Check</div>
						<div class="divTableRows">
							<div id="libChkJquery">
								<div><div class="iconQues"></div></div>
								<div>jQuery</div>
								<div></div>
							</div>
							<div id="libChkSprLib">
								<div><div class="iconQues"></div></div>
								<div>SpRestLib</div>
								<div></div>
							</div>
							<div id="libChkTsorter">
								<div><div class="iconQues"></div></div>
								<div>TableSorter</div>
								<div></div>
							</div>
						</div>
					</div>
					<div data-name="col2" style="flex:2 1 auto;">
						<div class="subTitle">SharePoint Environment / Configuration</div>
						<div class="divTableRows">
							<div>
								<div><div class="iconInfo"></div></div><div>SpRestLib Base URL</div><div id="spBaseUrl"></div>
							</div>
							<div>
								<div><div class="iconInfo"></div></div><div>SpRestLib Version</div><div id="spVersion">?</div>
							</div>
							<div>
								<div><div class="iconInfo"></div></div><div>Current Date/Time</div><div id="spDateTime"></div>
							</div>
						</div>
					</div>
				</div>
				<p>
			</div>

			<div id="navtabSite" data-tab="Site Info" class="active">
				<div class="subTitle plain">Site Collection Information</div>
				<div id="boxInfo" class="modernTable" data-desc="Site Info Table">
					<div style="width:60%"><label>Site Name</label><span id="SiteName"></span></div>
					<div style="width:10%; text-align:center;"><label>Storage Used</label><span id="UsageTot"></span></div>
					<div style="width:10%; text-align:center;"><label>Percent Used</label><span id="UsagePct"></span></div>
					<div style="width:10%; text-align:center;"><label>Date Created</label><span id="DateCre"></span></div>
					<div style="width:10%; text-align:center;"><label>Last Modified</label><span id="DateMod"></span></div>
				</div>

				<div id="LISTS" class="subTitle" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
					<div class="arrow"></div>Lists &amp; Libraries
				</div>
				<div class="contTabSiteLists" style="display:none">
					<div id="boxOpts" class="modernFlex" data-desc="Site Info Table Options">
						<div>
							<span>Show Description?</span>
							<div class="contSwitch">
								<label class="switch"><input type="checkbox" onchange="$('.showDesc').toggle()" checked><span class="slider round"></span></label>
							</div>
						</div>
						<div>
							<span>Show Type Template?</span>
							<div class="contSwitch">
								<label class="switch"><input type="checkbox" onchange="$('.showTemp').toggle()"><span class="slider round"></span></label>
							</div>
						</div>
						<div data-desc="show dates?">
							<span>Show Dates?</span>
							<div class="contSwitch">
								<label class="switch"><input id="chkDate" type="checkbox" onchange="$('.showDate').toggle(); $('#tabSiteLists').trigger('update');"><span class="slider round"></span></label>
							</div>
						</div>
						<div data-desc="show features?">
							<span>Show Features?</span>
							<div class="contSwitch">
								<label class="switch"><input id="chkFeat" type="checkbox" onchange="$('.showFeat').toggle(); $('#tabSiteLists').trigger('update');"><span class="slider round"></span></label>
							</div>
						</div>
						<div data-desc="show hidden?">
							<span>Show Hidden Lists?</span>
							<div class="contSwitch">
								<label class="switch"><input id="chkHidn" type="checkbox" onchange="$('.showHidn').toggle()"><span class="slider round"></span></label>
							</div>
						</div>
						<div data-desc="export buttons" style="padding:7px">
							<button type="button" class="flatBtn small flatBtn-modGray" onclick="exportTabData('tabSiteLists')" style="margin-right:10px !important">CSV Export</button>
							<button type="button" class="flatBtn small flatBtn-modGray" onclick="exportTabData('tabSiteLists')">JSON Export</button>
						</div>
					</div>

					<table id="tabSiteLists" class="tabModern tablesorter">
						<thead>
							<tr>
								<th rowspan="2">Name / Description</th>
								<th rowspan="2" class="showType">Type</th>
								<th rowspan="2">Items</th>
								<th rowspan="2" class="showDate">Date Created</th>
								<th rowspan="2" class="showDate">Date Modified</th>
								<th colspan="3" class="showFeat sorter-false" style="text-align:center !important; border-bottom:1px solid white !important;">List Features</th>
								<th colspan="6" class="showPerm sorter-false" style="text-align:center !important; border-bottom:1px solid white !important;">List Permissions</th>
							</tr>
							<tr>
								<th class="showFeat"><abbr title="Are Attachments enabled?">Attachments?</abbr></th>
								<th class="showFeat"><abbr title="Is Versioning enabled?">Versioning?</abbr></th>
								<th class="showFeat"><abbr title="Force Checkout?">Force?</abbr></th>
								<th class="showPerm sorter-false">Full</th>
								<th class="showPerm sorter-false">Design</th>
								<th class="showPerm sorter-false">Edit</th>
								<th class="showPerm sorter-false">Contribute</th>
								<th class="showPerm sorter-false">Read/View</th>
								<th class="showPerm sorter-false">Approve</th>
							</tr>
						</thead>
						<tbody></tbody>
						<tfoot>
							<tr class="busy" style="display:none">
								<td colspan="14" style="text-align:center; border:1px solid #f1f1f1;">
									<div class="sprlib-spinner"><div class="sprlib-bounce1"></div><div class="sprlib-bounce2"></div><div class="sprlib-bounce3"></div></div>
								</td>
							</tr>
						</tfoot>
					</table>
				</div>

				<div id="GROUPS" class="subTitle" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
					<div class="arrow"></div>Groups &amp; Users
				</div>
				<div class="contTabSiteGroups" style="display:none">
					<table id="tabSiteGroups" class="tabModern tablesorter">
						<thead>
							<tr>
								<th>Title</th>
								<th>Owner</th>
								<th>Description</th>
								<th>Member(s)</th>
							</tr>
						</thead>
						<tbody></tbody>
						<tfoot>
							<tr class="busy" style="display:none">
								<td colspan="4" style="text-align:center; border:1px solid #f1f1f1;">
									<div class="sprlib-spinner"><div class="sprlib-bounce1"></div><div class="sprlib-bounce2"></div><div class="sprlib-bounce3"></div></div>
								</td>
							</tr>
						</tfoot>
					</table>
				</div>

				<div id="ROLES" class="subTitle" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
					<div class="arrow"></div>Roles
				</div>
				<div class="contTabSiteRoles" style="display:none">
					<table id="tabSiteRoles" class="tabModern tablesorter">
						<thead>
							<tr>
								<th>Name</th>
								<th>Description</th>
								<th>ID</th>
							</tr>
						</thead>
						<tbody></tbody>
						<tfoot>
							<tr class="busy" style="display:none">
								<td colspan="3" style="text-align:center; border:1px solid #f1f1f1;">
									<div class="sprlib-spinner"><div class="sprlib-bounce1"></div><div class="sprlib-bounce2"></div><div class="sprlib-bounce3"></div></div>
								</td>
							</tr>
						</tfoot>
					</table>
				</div>

				<div id="SUBSITES" class="subTitle" onclick="$(this).next('div').toggle('slow'); $(this).find('.arrow').toggleClass('active');" title="Click to Show/Hide">
					<div class="arrow"></div>Subsites
				</div>
				<div class="contTabSubsites" style="display:none">
					<div id="subsitesHeader" class="flex">
						<div>
							Click to load subsite information and storage data.<br>
							It is not loaded by default as each site has to be scanned and can be resource intensive.<br>
							(NOTE: storman has no API - csom, jsom, or REST - so the usage is gathering by loading each site's storman and parsing it)
						</div>
						<div style="vertical-align:top; text-align:right;">
							<button type="button" class="flatBtn flatBtn-blueLt" onclick="getStorman()">Load Subsite Info</button>
						</div>
					</div>

					<table id="tabSubsites" class="tabModern tablesorter">
						<thead>
							<tr>
								<th>Subsite Name</th>
								<th>Subsite URL</th>
								<th>Total Size (MB)</th>
								<th>Used %</th>
								<th>Created</th>
								<th>Last Modified</th>
								<th>Owners Group Members</th>
							</tr>
						</thead>
						<tbody></tbody>
						<tfoot>
							<tr class="busy" style="display:none">
								<td colspan="7" style="text-align:center; border:1px solid #f1f1f1;">
									<div class="sprlib-spinner"><div class="sprlib-bounce1"></div><div class="sprlib-bounce2"></div><div class="sprlib-bounce3"></div></div>
								</td>
							</tr>
						</tfoot>
					</table>
				</div>
			</div>

			<div id="navtabComp" data-tab="Site Compare">
				<div class="subTitle">Site Collection Compare</div>
				<p>
					Compare two SharePoint Site Collections side-by-side.<br>
					...
				</p>

				<h1>((WIP))</h1>

				<div id="contListSelect" class="divTable" style="width:auto; margin-bottom:20px;">
					<div class="th">
						Site Lists/Libraries
					</div>
					<div>
						<div class="sprlib-spinner"><div class="sprlib-bounce1"></div><div class="sprlib-bounce2"></div><div class="sprlib-bounce3"></div></div>
						<select id="selSiteLists" onchange="handleListChange()">
							<option value="">Select...</option>
						</select>
						<span>(only non-hidden Lists/Libraries are shown)</span>
					</div>
				</div>

				<div id="tabList-ListInfo" style="margin-bottom:20px;">
					<div class="subTitle">List Information</div>
					<div><pre><code class="language-javascript">sprLib.list('listName').info()</code></pre></div>
				</div>

				<div id="tabList-ListCols" style="margin-bottom:20px;">
					<div class="subTitle">List Columns</div>
					<div><pre><code class="language-javascript">sprLib.list('listName').cols()</code></pre></div>
				</div>
			</div>

			<div id="navtabSync" data-tab="Site Sync">
				<div class="subTitle">Site Collection Sync</div>
				<p>
					View/Execute code to sync SharePoint Site Collections.
				</p>
				<h1>((WIP))</h1>
			</div>
		</div>
	</div>
</body>
</html>
