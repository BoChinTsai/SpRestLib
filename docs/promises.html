<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Promise You Will Love It · SpRestLib</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Promise You Will Love It · SpRestLib"/><meta property="og:type" content="website"/><meta property="og:url" content="https://gitbrent.github.io/SpRestLib/index.html"/><meta property="og:description" content="## JavaScript Promises Have Arrived"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://gitbrent.github.io/SpRestLib/img/sprestlib.png"/><link rel="shortcut icon" href="/SpRestLib/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/hybrid.min.css"/><link rel="alternate" type="application/atom+xml" href="https://gitbrent.github.io/blog/atom.xml" title="SpRestLib Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://gitbrent.github.io/blog/feed.xml" title="SpRestLib Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-75147115-3', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><link rel="stylesheet" href="/SpRestLib/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/SpRestLib/"><img class="logo" src="/SpRestLib/img/sprestlib.svg" alt="SpRestLib"/><h2 class="headerTitleWithLogo">SpRestLib</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://github.com/gitbrent/SpRestLib/releases" target="_self">Download</a></li><li class="siteNavGroupActive"><a href="/SpRestLib/docs/installation.html" target="_self">Get Started</a></li><li class="siteNavGroupActive"><a href="/SpRestLib/docs/api-list.html" target="_self">API Documentation</a></li><li class=""><a href="/SpRestLib/blog" target="_self">SharePoint Guides</a></li><li class=""><a href="https://github.com/gitbrent/SpRestLib/" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Get Started</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Get Started</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/installation.html">Installation</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/SpRestLib/docs/promises.html">Promise You Will Love It</a></li></ul></div><div class="navGroup navGroupActive"><h3>Features</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-integration.html">Library Integration</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-promises.html">Promise-based Operations</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-node.html">SharePoint via Node.js</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-utilities.html">Utility Methods</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-list.html">List/Library (SPList) Methods</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-rest.html">REST API Methods</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-site.html">Site (SPSite) Methods</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-user.html">User Methods</a></li></ul></div><div class="navGroup navGroupActive"><h3>SpRestLib UI</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/ui-form-binding.html">Form Binding</a></li></ul></div><div class="navGroup navGroupActive"><h3>Help / Support</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/sp-auth-notes.html">SharePoint Authentication</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Promise You Will Love It</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="javascript-promises-have-arrived"></a><a href="#javascript-promises-have-arrived" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JavaScript Promises Have Arrived</h2>
<p>What makes a good library great?  The ability to chain and group asynchronous operations!</p>
<p>SpRestLib not only provides a simple REST interface, it also delivers next-generation
async operation handling via <a href="http://www.datchley.name/es6-promises/">ES6 Promises</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="simple-chains-for-async-operations"></a><a href="#simple-chains-for-async-operations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simple Chains For Async Operations</h2>
<p>SharePoint applications frequently perform lots of operations (e.g.: read from many lists at startup)
or perform sequential steps (e.g.: get an item, then do further operations depending upon the result).
Until recently, using callbacks was the standard way to handle async completion, but with Promises
(which all SpRestLib methods return) operations can be easily chained by using <code>then()</code>, making your code
much easier to write and maintain.</p>
<p>See the <a href="#async-operations-via-promises">Async Operations via Promises</a> section for more information and examples.</p>
<h2><a class="anchor" aria-hidden="true" id="promises-example"></a><a href="#promises-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Promises Example</h2>
<pre><code class="hljs css javascript"><span class="hljs-comment">// EX: Get the current user's ID, then get their Tasks</span>
sprLib.user().info()
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objUser</span>)</span>{
    <span class="hljs-keyword">return</span> sprLib.list(<span class="hljs-string">'Tasks'</span>).items({ <span class="hljs-attr">queryFilter</span>:<span class="hljs-string">'Owner/Id eq '</span> + objUser.Id });
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arrItems</span>)</span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Current user's Tasks = "</span> + arrItems.length);
})
.catch(<span class="hljs-function"><span class="hljs-params">errMsg</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(errMsg));
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="async-await-example"></a><a href="#async-await-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Async/Await Example</h2>
<p>You can also use the native async/await syntax as async/await is built on JavaScript Promises.<br>
(Available in recent browsers, Node.JS 8.6+, or via transpiling with BabelJS)</p>
<p>Async/Await makes using SpRestLib even simplier as the asynchronous nature of web service calls is
masked by the abilty to declare a variable against an operation that will run in the background, etc.
Meaning you can write code that runs in a &quot;normal&quot;, linear fashion as shown below.</p>
<pre><code class="hljs css javascript"><span class="hljs-keyword">const</span> infoGetter = <span class="hljs-keyword">async</span>() =&gt; {
    <span class="hljs-comment">// EX: Get the current user's ID, then get their Tasks</span>
    <span class="hljs-keyword">const</span> objUser = <span class="hljs-keyword">await</span> sprLib.user().info();
    <span class="hljs-keyword">const</span> arrItems = <span class="hljs-keyword">await</span> sprLib.list(<span class="hljs-string">'Tasks'</span>).items({ <span class="hljs-attr">queryFilter</span>:<span class="hljs-string">'Owner/Id eq '</span> + objUser.Id });
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Current user's Tasks = "</span> + arrItems.length);
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="installation.html">← Installation</a><a class="docs-next button" href="feat-integration.html">Library Integration →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#javascript-promises-have-arrived">JavaScript Promises Have Arrived</a></li><li><a href="#simple-chains-for-async-operations">Simple Chains For Async Operations</a></li><li><a href="#promises-example">Promises Example</a></li><li><a href="#async-await-example">Async/Await Example</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/SpRestLib/" class="nav-home"><img src="/SpRestLib/img/sprestlib.svg" alt="SpRestLib" width="66" height="58"/></a><div><h5>Docs</h5><a href="/SpRestLib/docs/installation.html">Getting Started with SpRestLib</a><a href="/SpRestLib/docs/api-rest.html">SharePoint API Reference</a><a href="/SpRestLib/blog">SharePoint Development Guides</a><a href="/SpRestLib/docs/feat-promises.html">About JavaScript Promises</a></div><div><h5>Community</h5><a href="https://twitter.com/SpRestLib" target="_blank">Twitter</a><a href="https://plus.google.com/u/1/113247436909611337609" target="_blank">Google Plus</a><a href="http://stackoverflow.com/questions/tagged/sprestlib" target="_blank">Stack Overflow</a><a href="https://www.youtube.com/channel/UCxZcCampOHn-47kvtcK_oVQ" target="_blank">YouTube Channel</a></div><div><h5>More</h5><a href="https://github.com/gitbrent/sprestlib/issues">GitHub Issues</a><a href="https://github.com/gitbrent/sprestlib">GitHub Project</a><a href="https://www.flaticon.com/packs/creativity">Site Icons</a></div></section><section class="copyright">Copyright © 2018 Brent Ely</section></footer></div><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script></body></html>